<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WebP to PNG Converter</title>
<style>
  #dropArea {
    border: 2px dashed #cccccc;
    width: 300px;
    height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }
  #inputImage {
    display: none;
  }
  #outputImage {
    display: none;  /* Hide the image element initially */
  }
</style>
</head>
<body>

<div id="dropArea" ondragover="preventDefault(event)" ondrop="handleDrop(event)" onclick="document.getElementById('inputImage').click()">ドロップエリア</div>
<input type="file" id="inputImage" accept="image/webp" onchange="handleFileSelect(event)" style="display:none;"/>

<canvas id="canvas" style="display:none;"></canvas>

<img id="outputImage" alt="Converted Image"/>

<script>
  function preventDefault(event) {
    event.preventDefault();
  }

  function handleDrop(event) {
    event.preventDefault();
    const inputImage = event.dataTransfer.files[0];
    processImage(inputImage);
  }

  function handleFileSelect(event) {
    const inputImage = event.target.files[0];
    processImage(inputImage);
  }

  function processImage(inputImage) {
    if(inputImage && inputImage.type === 'image/webp') {
      convertToPNG(inputImage);
    } else {
      alert('Please select a WebP image.');
    }
  }

  function convertToPNG(inputImage) {
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    
    const img = new Image();
    img.src = URL.createObjectURL(inputImage);
    
    img.onload = function() {
      canvas.width = img.width;
      canvas.height = img.height;
      ctx.drawImage(img, 0, 0);
      
      const pngURL = canvas.toDataURL('image/png');
      const outputImage = document.getElementById('outputImage');
      outputImage.src = pngURL;
      outputImage.style.display = 'block';  /* Show the image element once the image is loaded */
    };
  }
</script>

</body>
</html>
